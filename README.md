# Spring AI 与 LangGraph4j: 对智能体交互
# 一、前置准备
## 1. 环境要求
+ JDK 17+（Spring AI 推荐版本） 
+ Maven 3.8+
+ Spring Boot 3.2+ 
+ 一个可用的 AI 模型 API 密钥（如 OpenAI GPT-4、Anthropic Claude，或本地化模型如 Llama 3） 
+ 可选：数据库（本教程用 H2 内存库模拟订单数据）
## 2、核心依赖
   在实现该项目之前，主要涉及的依赖就是 spring ai 相关核心依赖和 langGraph4j 的相关依赖。本次使用的 langGraph4j 为最新的版本 1.7.4、
   主要的依赖 pom 文件如下:
   参考本项目的 `pom.xml` 文件内容
# 二、核心架构
## 核心流程
用户需求 → 任务拆解 Agent → 数据查询 Agent → 数据分析 Agent → 报告生成 Agent → 结果校验 Agent → 输出最终报告
## 多智能体分工
| 智能体         | 核心职责                                                     | 依赖工具/组件               |
| -------------- | ------------------------------------------------------------ | --------------------------- |
| 任务拆解 Agent | 解析用户需求，提取关键信息（时间范围，指标，分析维度）       | AI模型                      |
| 数据查询 Agent | 根据拆解的条件，查询数据库获取原始数据                       | Spring AI 数据库工具、H2 库 |
| 数据分析 Agent | 对原始数据进行统计分析（计算 Top3、增长率），提炼关键结论    | AI 模型、数据处理工具       |
| 报告生成 Agent | 将分析结论整理为结构化报告（标题、核心数据、原因分析、建议） | AI 模型                     |
| 结果校验 Agent | 检查报告是否满足用户需求（完整性、准确性），不满足则返回重试 | AI 模型                     |

# 三、运行结果
执行测试用例后，控制台会输出各智能体的执行日志，最终打印结构化报告，示例如下：
```text
==================== 最终数据分析报告 ====================
 **报告标题：** 《2025年第三季度电商订单数据分析，销量Top3[品类]分析报告》

**核心数据：**
- 电子产品（Total Sales: 1,199,700）占总销量65.4%。
- 服装（Total Sales: 319,800）占总销量23.4%。
- 食品（Total Sales: 238,800）占总销量11.2%。

**原因分析：**
- 电子产品领先的可能原因包括广泛适用范围、高科技发展、新兴产品流行，以及在电商平台上更多优惠和促销活动。
- 服装领次的可能原因包括季节性消费习惯、时尚受欢迎、价格比较合适，以及与娱乐性质相关的活动导致流行。
- 食品排名尾巴可能原因包括基础需求低于前2名、市场上存在多种选择，导致价格较低而受欢迎度低的产品占据较大比例。

**业务建议：**
- 为了挑战电子产品，可以考虑更多优惠活动或促销推广，吸引更多消费者购买。同时，重视每个品类的市场趋势和需求，进行定位和商品选择。
- 对于食品品类，可以考虑降低价格或提供更高质量的产品来增加销售额。此外，可以学习电子产品和服装品类的营销策略，并将其适用到食品品类中。
- 为了促进服装销量增长，可以考虑与娱乐性质相关的活动配合发布新款商品，以引起消费者兴趣。同时，根据市场需求调整产品价格来适应不同客户群体。

**注意事项：** 本报告基于2025年第三季度的电商订单数据进行分析。为了更好地支持业务决策，建议定期重复此类分析，以便及时了解市场趋势和需求变化。

**签名：** [您的姓名] [您的职位] [您的电子邮箱] [日期]
```
